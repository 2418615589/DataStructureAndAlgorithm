%%  
M_0501=readsla('F:\sla\2005\01\');M_0502=readsla('F:\sla\2005\02\');
M_0503=readsla('F:\sla\2005\03\');M_0504=readsla('F:\sla\2005\04\');
M_0505=readsla('F:\sla\2005\05\');M_0506=readsla('F:\sla\2005\06\');
M_0507=readsla('F:\sla\2005\07\');M_0508=readsla('F:\sla\2005\08\');
M_0509=readsla('F:\sla\2005\09\');M_0510=readsla('F:\sla\2005\10\');
M_0511=readsla('F:\sla\2005\11\');M_0512=readsla('F:\sla\2005\12\');
M_0601=readsla('F:\sla\2006\01\');M_0602=readsla('F:\sla\2006\02\');
M_0603=readsla('F:\sla\2006\03\');M_0604=readsla('F:\sla\2006\04\');
M_0605=readsla('F:\sla\2006\05\');M_0606=readsla('F:\sla\2006\06\');
M_0607=readsla('F:\sla\2006\07\');M_0608=readsla('F:\sla\2006\08\');
M_0609=readsla('F:\sla\2006\09\');M_0610=readsla('F:\sla\2006\10\');
M_0611=readsla('F:\sla\2006\11\');M_0612=readsla('F:\sla\2007\12\');
M_0701=readsla('F:\sla\2007\01\');M_0702=readsla('F:\sla\2007\02\');
M_0703=readsla('F:\sla\2007\03\');M_0704=readsla('F:\sla\2007\04\');
M_0705=readsla('F:\sla\2007\05\');M_0706=readsla('F:\sla\2007\06\');
M_0707=readsla('F:\sla\2007\07\');M_0708=readsla('F:\sla\2007\08\');
M_0709=readsla('F:\sla\2007\09\');M_0710=readsla('F:\sla\2007\10\');
M_0711=readsla('F:\sla\2007\11\');M_0712=readsla('F:\sla\2007\12\');
M_0801=readsla('F:\sla\2008\01\');M_0802=readsla('F:\sla\2008\02\');
M_0803=readsla('F:\sla\2008\03\');M_0804=readsla('F:\sla\2008\04\');
M_0805=readsla('F:\sla\2008\05\');M_0806=readsla('F:\sla\2008\06\');
M_0807=readsla('F:\sla\2008\07\');M_0808=readsla('F:\sla\2008\08\');
M_0809=readsla('F:\sla\2008\09\');M_0810=readsla('F:\sla\2008\10\');
M_0811=readsla('F:\sla\2008\11\');M_0812=readsla('F:\sla\2008\12\');
M_0901=readsla('F:\sla\2009\01\');M_0902=readsla('F:\sla\2009\02\');
M_0903=readsla('F:\sla\2009\03\');M_0904=readsla('F:\sla\2009\04\');
M_0905=readsla('F:\sla\2009\05\');M_0906=readsla('F:\sla\2009\06\');
M_0907=readsla('F:\sla\2009\07\');M_0908=readsla('F:\sla\2009\08\');
M_0909=readsla('F:\sla\2009\09\');M_0910=readsla('F:\sla\2009\10\');
M_0911=readsla('F:\sla\2009\11\');M_0912=readsla('F:\sla\2009\12\');
M_1001=readsla('F:\sla\2010\01\');M_1002=readsla('F:\sla\2010\02\');
M_1003=readsla('F:\sla\2010\03\');M_1004=readsla('F:\sla\2010\04\');
M_1005=readsla('F:\sla\2010\05\');M_1006=readsla('F:\sla\2010\06\');
M_1007=readsla('F:\sla\2010\07\');M_1008=readsla('F:\sla\2010\08\');
M_1009=readsla('F:\sla\2010\09\');M_1010=readsla('F:\sla\2010\10\');
M_1011=readsla('F:\sla\2010\11\');M_1012=readsla('F:\sla\2010\12\');
M_1101=readsla('F:\sla\2011\01\');M_1102=readsla('F:\sla\2011\02\');
M_1103=readsla('F:\sla\2011\03\');M_1104=readsla('F:\sla\2011\04\');
M_1105=readsla('F:\sla\2011\05\');M_1106=readsla('F:\sla\2011\06\');
M_1107=readsla('F:\sla\2011\07\');M_1108=readsla('F:\sla\2011\08\');
M_1109=readsla('F:\sla\2011\09\');M_1110=readsla('F:\sla\2011\10\');
M_1111=readsla('F:\sla\2011\11\');M_1112=readsla('F:\sla\2011\12\');
M_1201=readsla('F:\sla\2012\01\');M_1202=readsla('F:\sla\2012\02\');
M_1203=readsla('F:\sla\2012\03\');M_1204=readsla('F:\sla\2012\04\');
M_1205=readsla('F:\sla\2012\05\');M_1206=readsla('F:\sla\2012\06\');
M_1207=readsla('F:\sla\2012\07\');M_1208=readsla('F:\sla\2012\08\');
M_1209=readsla('F:\sla\2012\09\');M_1210=readsla('F:\sla\2012\10\');
M_1211=readsla('F:\sla\2012\11\');M_1212=readsla('F:\sla\2012\12\');
M_1301=readsla('F:\sla\2013\01\');M_1302=readsla('F:\sla\2013\02\');
M_1303=readsla('F:\sla\2013\03\');M_1304=readsla('F:\sla\2013\04\');
M_1305=readsla('F:\sla\2013\05\');M_1306=readsla('F:\sla\2013\06\');
M_1307=readsla('F:\sla\2013\07\');M_1308=readsla('F:\sla\2013\08\');
M_1309=readsla('F:\sla\2013\09\');M_1310=readsla('F:\sla\2013\10\');
M_1311=readsla('F:\sla\2013\11\');M_1312=readsla('F:\sla\2013\12\');
M_1401=readsla('F:\sla\2014\01\');M_1402=readsla('F:\sla\2014\02\');
M_1403=readsla('F:\sla\2014\03\');M_1404=readsla('F:\sla\2014\04\');
M_1405=readsla('F:\sla\2014\05\');M_1406=readsla('F:\sla\2014\06\');
M_1407=readsla('F:\sla\2014\07\');M_1408=readsla('F:\sla\2014\08\');
M_1409=readsla('F:\sla\2014\09\');M_1410=readsla('F:\sla\2014\10\');
M_1411=readsla('F:\sla\2014\11\');M_1412=readsla('F:\sla\2014\12\');
%%
EOF=[M_0501(:),M_0502(:),M_0503(:),M_0504(:),M_0505(:),M_0506(:),M_0507(:),M_0508(:),M_0509(:),M_0510(:),M_0511(:),M_0512(:),...
    M_0601(:),M_0602(:),M_0603(:),M_0604(:),M_0605(:),M_0606(:),M_0607(:),M_0608(:),M_0609(:),M_0610(:),M_0611(:),M_0612(:),...
    M_0701(:),M_0702(:),M_0703(:),M_0704(:),M_0705(:),M_0706(:),M_0707(:),M_0708(:),M_0709(:),M_0710(:),M_0711(:),M_0712(:),...
    M_0801(:),M_0802(:),M_0803(:),M_0804(:),M_0805(:),M_0806(:),M_0807(:),M_0808(:),M_0809(:),M_0810(:),M_0811(:),M_0812(:),...
    M_0901(:),M_0902(:),M_0903(:),M_0904(:),M_0905(:),M_0906(:),M_0907(:),M_0908(:),M_0909(:),M_0910(:),M_0911(:),M_0912(:)...
    ,M_1001(:),M_1002(:),M_1003(:),M_1004(:),M_1005(:),M_1006(:),M_1007(:),M_1008(:),M_1009(:),M_1010(:),M_1011(:),M_1012(:),...
    M_1101(:),M_1102(:),M_1103(:),M_1104(:),M_1105(:),M_1106(:),M_1107(:),M_1108(:),M_1109(:),M_1110(:),M_1111(:),M_1112(:),...
    M_1201(:),M_1202(:),M_1203(:),M_1204(:),M_1205(:),M_1206(:),M_1207(:),M_1208(:),M_1209(:),M_1210(:),M_1211(:),M_1212(:),...
    M_1301(:),M_1302(:),M_1303(:),M_1304(:),M_1305(:),M_1306(:),M_1307(:),M_1308(:),M_1309(:),M_1310(:),M_1311(:),M_1312(:),...
    M_1401(:),M_1402(:),M_1403(:),M_1404(:),M_1405(:),M_1406(:),M_1407(:),M_1408(:),M_1409(:),M_1410(:),M_1411(:),M_1412(:)];
EOF=EOF';
EOF=detrend(squeeze(EOF));
EOF(isnan(EOF))=0.0;
[V,EOFs,EC,error]=EOF_my(EOF',5);
EC = reshape(EC,81,61,5);
V1=V./sum(V);
disp(V1);

plot(EOFs(:,3));
hold on 
y=zeros(1,120);
plot(y,'-.k')
set(gcf,'color','w') 
ylabel('EOF时间系数');
xlabel('年份');
%%

lat=20:0.25:40;
lon=115:0.25:130;
spatial_distribution1=EC(:,:,1);
[Lon,Lat]=meshgrid(lon,lat);
% subplot('position',[0.1,0.45,0.8,0.4])
m_proj('Mercator','lon',[115 130],'lat',[20 40]);
m_pcolor(Lon,Lat,spatial_distribution1);shading interp
hold on
m_coast('patch',[.6 .7 .7]);
m_grid('linestyle','none','box','fancy','tickdir','out');
colorbar;
set(gcf,'color','w') 
xlabel('经度');
ylabel('纬度');
%%
a=max(M_0502);a=max(a);
b=max(M_0505);b=max(b);
c=max(M_0508);c=max(c);
d=max(M_0511);d=max(d);
subplot(1,4,1)
b= isnan(M_0502);
M_0502(find(b==1))=255;
map = colormap(jet);
map(end,:) =255;  %改变colcormap的颜色映射，将最大值得颜色设置为黑色
imshow(M_0502*100);
set( gca, 'Clim',[-40,40]);
map = colormap(jet);
map(end,:) = 1;  %改变colcormap的颜色映射，将最大值得颜色设置为黑色
colormap(map);
% h = colorbar;
% set(h,'Ylim',[-20,20]);
% t=get(h,'YTickLabel');
% t=strcat(t,'cm');
% set(h,'YTickLabel',t);
% set(gcf,'unit','centimeters','position',[5 5 20 20]);
% set(gca,'Position',[.1 .1 .7 .65]);
% set(gcf,'Position',[100 100 560 620]);
axis on  %打开坐标轴
set(gca,'linewidth',2)   %设置坐标轴线宽为３
[x,y] = size(M_0502);     %获取图像大小 
sepy = y/3;
sepx = x/4;
set(gca,'xtick',[1,sepy,2*sepy,y]);      %设置横坐标显示刻度位置
set(gca,'xticklabel',{'115°E','120°E','125E°','130°E'});     %将横坐标显示为经纬度
set(gca,'ytick',[1,sepx,2*sepx,3*sepx,x]);      %同上
set(gca,'yticklabel',{'40°N','35°N','30°N','25°N',''});
set(gcf,'color','w');
xlabel('经度');
ylabel('纬度');
%%
subplot(1,4,2)
b= isnan(M_0505);
M_0502(find(b==1))=255;
map = colormap(jet);
map(end,:) =255;  %改变colcormap的颜色映射，将最大值得颜色设置为黑色
imshow(M_0505*100);
set( gca, 'Clim',[-40,40]);
map = colormap(jet);
map(end,:) = 1;  %改变colcormap的颜色映射，将最大值得颜色设置为黑色
colormap(map);
% h = colorbar;
% set(h,'Ylim',[-20,20]);
% t=get(h,'YTickLabel');
% t=strcat(t,'cm');
% set(h,'YTickLabel',t);
% set(gcf,'unit','centimeters','position',[5 5 20 20]);
% set(gca,'Position',[.1 .1 .7 .65]);
% set(gcf,'Position',[100 100 560 620]);
axis on  %打开坐标轴
set(gca,'linewidth',2)   %设置坐标轴线宽为３
[x,y] = size(M_0505);     %获取图像大小 
sepy = y/3;
sepx = x/4;
set(gca,'xtick',[1,sepy,2*sepy,y]);      %设置横坐标显示刻度位置
set(gca,'xticklabel',{'115°E','120°E','125E°','130°E'});     %将横坐标显示为经纬度
set(gca,'ytick',[1,sepx,2*sepx,3*sepx,x]);      %同上
set(gca,'yticklabel',{'40°N','35°N','30°N','25°N',''});
set(gcf,'color','w');
xlabel('经度');
ylabel('纬度');
%%
subplot(1,4,3)
b= isnan(M_0508);
M_0502(find(b==1))=255;
map = colormap(jet);
map(end,:) =255;  %改变colcormap的颜色映射，将最大值得颜色设置为黑色
imshow(M_0508*100);
set( gca, 'Clim',[-40,40]);
map = colormap(jet);
map(end,:) = 1;  %改变colcormap的颜色映射，将最大值得颜色设置为黑色
colormap(map);
% h = colorbar;
% set(h,'Ylim',[-20,20]);
% t=get(h,'YTickLabel');
% t=strcat(t,'cm');
% set(h,'YTickLabel',t);
% set(gcf,'unit','centimeters','position',[5 5 20 20]);
% set(gca,'Position',[.1 .1 .7 .65]);
% set(gcf,'Position',[100 100 560 620]);
axis on  %打开坐标轴
set(gca,'linewidth',2)   %设置坐标轴线宽为３
[x,y] = size(M_0511);     %获取图像大小 
sepy = y/3;
sepx = x/4;
set(gca,'xtick',[1,sepy,2*sepy,y]);      %设置横坐标显示刻度位置
set(gca,'xticklabel',{'115°E','120°E','125E°','130°E'});     %将横坐标显示为经纬度
set(gca,'ytick',[1,sepx,2*sepx,3*sepx,x]);      %同上
set(gca,'yticklabel',{'40°N','35°N','30°N','25°N',''});
set(gcf,'color','w');
xlabel('经度');
ylabel('纬度');
%%
subplot(1,4,4)
b= isnan(M_0511);
M_0502(find(b==1))=255;
map = colormap(jet);
map(end,:) =255;  %改变colcormap的颜色映射，将最大值得颜色设置为黑色
imshow(M_0511*100);
set( gca, 'Clim',[-40,40]);
map = colormap(jet);
map(end,:) = 1;  %改变colcormap的颜色映射，将最大值得颜色设置为黑色
colormap(map);
% h = colorbar;
% set(h,'Ylim',[-20,20]);
% t=get(h,'YTickLabel');
% t=strcat(t,'cm');
% set(h,'YTickLabel',t);
% set(gcf,'unit','centimeters','position',[5 5 20 20]);
% set(gca,'Position',[.1 .1 .7 .65]);
% set(gcf,'Position',[100 100 560 620]);
axis on  %打开坐标轴
set(gca,'linewidth',2)   %设置坐标轴线宽为３
[x,y] = size(M_0511);     %获取图像大小 
sepy = y/3;
sepx = x/4;
set(gca,'xtick',[1,sepy,2*sepy,y]);      %设置横坐标显示刻度位置
set(gca,'xticklabel',{'115°E','120°E','125E°','130°E'});     %将横坐标显示为经纬度
set(gca,'ytick',[1,sepx,2*sepx,3*sepx,x]);      %同上
set(gca,'yticklabel',{'40°N','35°N','30°N','25°N',''});
set(gcf,'color','w');
xlabel('经度');
ylabel('纬度');
h=colorbar('SouthOutside')
set(h,'Position',[0.2   0.2  0.6   0.05])
 t=get(h,'XTickLabel');
 t=strcat(t,'cm');
 set(h,'XTickLabel',t);
 gtext('a');
 gtext('b');gtext('c');gtext('d');
